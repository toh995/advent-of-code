module Day21.Part02Spec (spec) where

import Test.Hspec

import Day21.Part02

spec :: Spec
spec = do
  it "numPairs works" $ do
    numPairs (-124) `shouldBe` 0
    numPairs 0 `shouldBe` 1
    numPairs 1 `shouldBe` 4
    numPairs 2 `shouldBe` 8
    numPairs 3 `shouldBe` 12
    numPairs 4 `shouldBe` 16
    numPairs 5 `shouldBe` 20
    numPairs 6 `shouldBe` 24

  it "numReachableCells works" $ do
    -- numReachableCells gridLen totalSteps distance =
    let gridLen = 131
    let totalSteps = 26501365
    let distance = totalSteps - gridLen
    numReachableCells gridLen totalSteps distance `shouldBe` 4

    let distance' = totalSteps - (gridLen * 2)
    numReachableCells gridLen totalSteps distance' `shouldBe` 1 + 8

  it "part2 works" $ do
    let totalStepsList = [0, 1, 2, 3, 4, 5]
    part2 matrix <$> totalStepsList
      `shouldBe` [1, 4, 8 + 1, 4 + 11, 8 + 1 + 14, 4 + 11 + 18]

-- let totalSteps = 6
-- part2 smallMatrix totalSteps
--   `shouldBe` sum
--     [ 1
--     , 8
--     ,
--     ]

smallMatrix :: Matrix Char
smallMatrix =
  buildMatrix
    [ "......."
    , "......."
    , "......."
    , "...S..."
    , "......."
    , "......."
    , "......."
    ]

matrix :: Matrix Char
matrix =
  buildMatrix
    [ "..................................................................................................................................."
    , ".##.....#.........#........#...#......#.#.#..#..#......#....#..............#..............#........#...#.#....#...#....##.#.....#.."
    , "...........#..#.....##.#.##...........#.##.......#.....................##....#.#..#....#.#......##.....#...#....#....#.....#......."
    , ".....#.#..................##.....#.#...#............#.#...........................#..............#......#.......#.##..............."
    , ".........#...#.........#.##......#.#...#..#.#.#......#.#..................##.#...#...........#..............#....#....#....#......."
    , "..##.......#.#...#.#.#......#.#..##.##.#.........#..#.............#..........#...##.###................#.#........................."
    , "..............##......#...........#.#....#.#......#...##.......#.............#........#....#...#..#.#.........#.....#...#...#..#..."
    , "......##..#.#.###..#.......#............#...#.....#.#..........................#.##....##....#.#....#.#.....#.#....#.....#........."
    , ".........#...#.#..#.....##.....#.#....#........#..#..........#..#.................#...................#.....#....#..........#......"
    , ".##........................#.........#....#....................#................#....#.#..#..##.#..#......#..#..............#......"
    , "..#.#.......##..#..#.................#..............................#.#.........##...............#..#.#.....#.....##.........##...."
    , ".......#.#..##.###....#.##...#.#..#.#.##........##...............................#......#............#.....#...#.##....#.#.....#..."
    , ".................#......#............#..#....................#....#.....##.......#.......#..#............#.#....#.##.#............."
    , "..#...#..##.....#.....#....#...#.#..#..........#..........#..##.#..##..#...........#.......#......##....#.#........#........#..###."
    , ".#......#................#.#.#.........##.....#...........##....#...#.....#...............###..#....##......#..#....##.......#.#..."
    , "..#.....#........#....#....#.###..#.#........#....................#.....##..........#.............#.#.....#...........#............"
    , ".#.##...............#.....#....#....#.......#..................#...#.......##.........#.......................#...#.........#...#.."
    , ".#.........#.........###.....#.##......#...................#....#.....##.###................#..............#.......#..#.#.........."
    , ".........#...#......#..###.....##........#...........#.......#....#.....##.................##.....#.#....#....##.#..#....#........."
    , ".#.................#....#......#...............................#.....#.........................#...#........#....#................."
    , "...#........#...............##.#..#..............#.....#...#.#....#.....#..................#....#.....####...#........##..........."
    , ".....................#...#...#.......#.................#.#...##.#....#.....#...##.................#....###.#....#...#........#....."
    , "..........#.........#.........#..#....................##.......#..#......#.................#...#..............#.#..#....#.........."
    , ".#.#..##.........#.....##..#...#................##....#......#.........#..#.#.#...............#.......#.....................#.#...."
    , "....#.#...#.#........#.......#.#...#...............##..............#............##.................#....#....#.##.....#.#........#."
    , "..#.....#......#........#........#...........#....................#..#........#.....................#.#.#.................##.....#."
    , "...#..##........#.....#...........#.........#..#.#............##.....#.#..............#........#........#..#.....#................."
    , "......#......#....#....#....#........................#......#..##...##....#........##...........................#...#...#...#......"
    , ".#........#..#...#...#...##...##...........###.......#.........#....#.....#.#..#.........#........#...#...#.#........#............."
    , "...#...............#...#................#....#.##..........#.......#...#..#......#....##.......................#.#..##.......#...#."
    , ".#....#.....#.......###..##...............##....#..#..............###..#..#.....#....#.....................#..#....###.#...##....#."
    , "...#........#...#.......................#..........#.....###..###.............##.........#...........#.#..#..#..##.......#....#...."
    , "..#....##......#........###.................#...............#...........#...........................................#.........#...."
    , "......##....#.#.#.....................#............#...###.........#....#......#....###..................#.....#..................."
    , "...#.................#.#..............#.#.#.........#........#.....##......#..#......#.........#..............#####............###."
    , ".................#...#......................#...#............#.....##.#....#..#....#...#.##.................##.................#..."
    , "........#.....................................#.#.#.........#..#...#...............#.......#.....#............#...........#........"
    , ".......#.#....#........#...............###............#........#........#....#..#..........................#.....#..#...#....#....."
    , "..#...#...........#.............#...........###.....#..#...........##...#...........#...#.......#..........#......##..###......#..."
    , ".#..........#.#...##............#.##...#.......#.#.............#...#.#...##.............#....#....#.........#.#...#...#.......#.##."
    , "............#.#...................#......#....#..##....#.#.#.#.#......#..........#......#.#..............................#.....#..."
    , "..#..#.........#...##........#.#.........#..#...#...........#.............#.#.....#.....#....##.....##............................."
    , ".....#........#.................#.#.......##..#........#.......#......##........#......#......##...............##...........#...#.."
    , ".#..........................#..##..#.....#...#...#........#...##..#.....##.##........#..#........#...#...........#................."
    , "..#.#......#...##.........#......#..........#.............#...#..........#.#.......#........#...#..#................##............."
    , "..#.....#.#..#............#.......................#.#...#...#.......#.....#.....#..#.......##...#..................#.............#."
    , ".......#.##..#.............#...##...#..#..##............#..#.##......#......#..#..#.#.#......#......#..#...........#.........#....."
    , "..........##...................#................##....#...........#.....................#.....#................................#..."
    , "...#.#.......#...........#...#....#..#.#...#.....#..#........#......#......#.#.#.........#.......#....###.#...........#............"
    , ".#..#.......#..............#.....#..#........#...#......#......#........#..........................##........#....................."
    , "......#.#.#............#.....#..........#...#...#....#...#.##..#...#...#......#........#.#.#.#.....##.......##...................#."
    , ".......#...............#...#...................#.....#..........#.....##.................#.#.........##..###......................."
    , ".#.#..............##...#...#.....#.........#...........#.....###....#...........#.#.......##..##.......#.#........................."
    , "...#..#.........#..#...#..............##.#......#..........#.......#...#....#..#.......................#.#.......#.............#..."
    , "...#...#.............#......#.....#............#..##............#...#.#.#.##.......#....##........#........##..#..#.........#......"
    , "................#..#.............#......##.#.##...#...#....#...........#...#.....#.....#..#.#.#....##...#...................##..#.."
    , ".......................#..#.......##....#..#.#........#........#..#..###....#..........#..#..#........##..#...................#...."
    , "..#...........#......#.####..........#.#.......#........#.............#........#...#...#......#....#...#...#......................."
    , "..#........#.................#.##.#...#....#.....#....#...#........#.....#.##.........#.#........#......#.##.#....#.##.#........#.."
    , "................#.#..............#........#.###.#.#..................................#.##.....#.#.##.#...#...#.#...##.............."
    , "...............#.....#...........###....#.#...#....##......#..#.....#....................#..#..........#....#.........#............"
    , "..............##...#....#.#.##...#....#........###.....#.#..#..#..........#.........##...#......#.#...#...#.#...#..#...#..#........"
    , "..........#.......#.............#.................#...............#.....##......##...........#..##..#......#......#..#.#..........."
    , "........#...#........#..............#...............#.#..#..#.................###.......#......#....#......#.#..#..#..............."
    , "........###...#...#...#.#......#....#...#...........#.....#................#...........###..#.............#....#..................."
    , ".................................................................S................................................................."
    , "...........#...#..#.#.........#...##....................##.#.###.........#...........##...............#....................#......."
    , "......#.................#..........#.........#..##....#......##.......#.#.............#...............#.###......#.#......#........"
    , "................#.##.#......##........#....#.....#.......................#......#.......#................#####........#.#.........."
    , ".........#..#...#.....#...#....#..........#.#......#..#....#..#.....#.#...#...............#...###.#.#.#.#..#..#..#.#..#...#........"
    , "............#...###................................#..#.#...#......#..............#........#......#.#.....#.#.......#.............."
    , "..#.......#.......#.#.#.#........#....#.......#..#.....#.....#.....#...........#.......#..#.......#.......#....###......#.........."
    , ".....................................#...#..........#.....#....#..........#............#........#......####...........#............"
    , ".##...........#....#...#......#....##....##.#......#......#.......#..##.....#.....#.........#....#..#............#....#............"
    , "...................##..............##....###......#.#....##........#..........#..#.##......#.......#.........#....................."
    , "..##..#.......#..........................#.#..#.........#.......#.......#.....#..#......#...........#...........#.###........#....."
    , "..................#.#....###....####.#.......##.....#....#.....................................#...#...#......#...................."
    , ".###....#..............#.......#.##.##....#...###....#.##.#....##...............#.#..........#...........#.##.##..................."
    , ".....#.#.............#............#......##..#.........#.#..#...#.................#....#...#.......#...#..................#........"
    , "....#..#..........#.#.......##...#.....#...##.#....#.....#..#.......#..........#......................#..#................#.##.#..."
    , ".#...#...............#...#.....#...#..#...#....#.#...#.#...#.......#...#.......#......................###..#.................##...."
    , "......#...#.........#.#......#...##...##.....#...#...#...##...#......#...#....#####..........#...............#...........#.#...#.#."
    , ".#..........##...........................#...#....#..#............#.........#......#....#........#.....#.....#.................#.#."
    , "..##..#......#................#.......#.....#.......#.##....##..#......#.....#.............#....#..#...##.......................##."
    , "......#........#.........#.#....##.........##..............#..#.....#.#...#.......#........#...........................#.......#.#."
    , ".......#......##.............#...##.......#...#..#.........##..##.....##.#.....#.......#..................#........#.#....#.....#.."
    , "..#.......#.................#........#....#....##.##..........#.#......##..#...#......#...#........###.#...............#......##..."
    , "..........#.#..................###.#..............#...#.....#.#...#........#.#....#..#.......#..#.#.#........................#....."
    , "..#..........#.#............#.#.#......##...............#.#..#..#.###.....#..#..##.##............##.....................#...#.#...."
    , "...#.#..##.......#..........##.#.......#..#..........#.......#..#..........#..#.#...#.......#............................##....#..."
    , ".#..#.............#.##..........#...#...#.##...##.......#...#........##.#..#............##..##...................#......#.....#...."
    , ".......................................##....#.........#.....................................#...#..........#.#....#........#......"
    , "....#......#.#...................#.#.......#.#.......#..#.#.#.....#...........#.#.##.......##.....#...........##........##....#.##."
    , ".........#.........##............#......#.##.##....##.......#..............#.##........##.#......#........#......###..........##.#."
    , "......#............#.#.......................#...#......#.#.....#...#.........#.#.#....#..................#.......##.......#......."
    , ".....#..#....#..#.........#.......#.#....#....#.#..........#......#..#.....#.......#.#.......#..............#....#................."
    , "....#.................#..#.........#....#......#.#....#.........#.........#..#...#....#.##......................#........#.#..#.#.."
    , ".#..#..............#.......#........#.....#......#..................#.#...#...#.#...#......#..........##.#.#.#.............#......."
    , ".#............#.#....##..................##..#.....#.....#................##..............##.#..................#.##..#....#..#.#.."
    , "......#.....##...##...##...#..............#.......##..#......##...#.....#....#.#.#........#...........#...#....#.........#........."
    , "...#....#..#.....#.......#.................................#..........#....#....#.......#...........#.#..#..#...........##...#..#.."
    , "............#...........#..#..............#...#.........#..............#..........#.#..#..........##......##..#...................."
    , "....#.#....#..#.......#......#..........................#.#.#.#.#.................#....................#.....###.......#......#...."
    , ".....#.....#..#............#.#..#......................#....#.......#..#....#..........................#.#.#......#.##.#..........."
    , ".......#..............#........#............#....#......#.#..#..............#.#.##.#.....................#....#............#..#.##."
    , "...#........................#....#..................#...#.#.###...#...#......#..##...##.......#.#.....#..........#..###..........#."
    , "....##....#....#.......#..##........#..........#.....#.#....#..#...#...........................#..#.......#.....#......#...#......."
    , ".....#...##.#...#...##...#.....................#.#....#..#.....#................#................#..#.#......................#....."
    , "........#...#.....##.##..#........#...##.........#..#.#.............##........#............#..###.....#.....#............#........."
    , ".#........##.....##....#...#...........#........................#.##.##.........##...............#..#...#...........#.......##.#..."
    , ".......#................#.#........................##......#........#......#.....#............#........#.....#.#...#...#.#.....#..."
    , ".......#.....#.#....#....#....###.....#...........#.....#.....#...##....##.....#..........#..#.#......#..###.#.........#...#...##.."
    , "...#.#........#....#..#.....#..#......#.#.##..........##........#...#.......................#..#......#......#.....#..........#...."
    , "..###.....#.........##.....#....#.##.....#..........#....##.........#..#...............#.............#.##.....#......#..#.........."
    , "...#..##...................##.#.....#.###....#................#............#.........#...........................#.......#.#......."
    , ".#....#.........................#...#.........#..........#..#.........#...#...........#.................#.............#.....##..##."
    , "...............#.....#...#....#...#......#................#.......##...............#..#.............#........#....#.##.#..........."
    , "....#............#...#............#....#......#.........###....#........#.........#.....#.#.##....#...#...............##..##......."
    , ".....#..#..................#....#...........#.#.#.......................#.........#.......#####..##....#.............#...#......##."
    , ".....#..#..#..................###......#....#....##...................#.#.......#..##....#.....#..........#.#....##.#.#..#......#.."
    , ".......##.........###..................#..........#................###..............##.##.#.#.#....#................#...#..#.#..#.."
    , ".#..#.........###.......#.....#......#.......#.................#..............##...#........#....#..#.....##.......#.....#........."
    , "..........#.....##.........#.........#.###.....#.#..............#....#...................................##...............#......#."
    , ".#...##..#...#.....##....#.#.#..........##.#................................#......##......#.........#..##..##.........##........#."
    , "......#.#.....#...........##.#..#.....#.......#........#....................#........##.#...#.....##...#.###..#..#....#........#..."
    , "....##...........##.....#...............##.#...#..#........................#......#........#.##.......#....#..#...#.........#..##.."
    , "....####.#....#.#.......##...###....#...##..#.#...................................#.......##....##.#.#.................#..##....##."
    , "........#.........#....#.......#.......#.#...........#..................#..#..#...##...#.....##....##.#..#.##.........#............"
    , ".#............#..#.#.....#......#.##.#.#.#..#....##..#..............................#....#........#.....#..........#...#......#...."
    , "............#.....#.#........##.#.....#......#.#.........#...............#.....#.#.#.##......#....#.#.....#.....................#.."
    , "..................................................................................................................................."
    ]
